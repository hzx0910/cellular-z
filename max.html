<html>
<head>
    <meta charset="utf-8">
    <title>Max课堂练习-最优停止策略</title>
    <script src="https://cdn.staticfile.org/Chart.js/3.9.1/chart.js"></script>
</head>
<body>
<div>
    <canvas id="myChart" width="400" height="340"></canvas>
</div>
<div style="margin-top:15px;padding-bottom:10px;text-align: center;margin:auto;">
    数量:
    <input id="inputSize" type="number" name="size" value="100">
    <button onclick="draw()">计算</button>
    <a style="margin-left:10px;" id="maxOutput">最大</a>
</div>

</body>

<script>
    var myChart;

    function ratio(n, k) {
        if (k < 0 || k >= n) return 0;
        if (k == 0) return 1 / n;
        var sum = 0;
        for (var i = k; i < n; i++) {
            sum += k / n / i;
        }
        return sum;
    }

    function draw() {
        var size = document.getElementById('inputSize').value;
        console.log("list ====== " + size);
        var max;
        var list = new Array();
        for (var i = 0; i < size; i++) {
            list[i] = {
                x: i,
                y: ratio(size, i)
            };
            if (max == null || list[i].y > max.y) max = list[i];
        }
        const data = {
            datasets: [{
                label: 'Max课堂练习-最优停止策略',
                data: list,
                backgroundColor: 'rgb(255, 99, 132)'
            }],
        };
        if (myChart == null) {
            myChart = new Chart(document.getElementById('myChart'), {
                type: 'scatter',
                data: data,
                options: {
                    responsive: true, // 设置图表为响应式，根据屏幕窗口变化而变化
                    maintainAspectRatio: false, // 保持图表原有比例
                    scales: {
                        x: {
                            type: 'linear',
                            position: 'bottom'
                        }
                    }
                }
            });
        } else {
            myChart.data = data;
            myChart.update();
        }
        if (max == null) document.getElementById('maxOutput').innerHTML = "";
        else document.getElementById('maxOutput')
            .innerHTML = "最大: " + max.x + " / " + new Number(max.y * 100)
            .toFixed(6) + "%";
    }
    draw();
</script>
</html>